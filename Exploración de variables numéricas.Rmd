---
title: "Proyecto_Mineria"
author: "Alejandro Anton"
date: "2026-02-09"
output: html_document
---
```{r librerias}
library(haven)
library(dplyr)
library(purrr)
library(janitor)
library(stringr)
library(readr)
```


```{r leer y corregir datos}
archivos <- list.files("./datos/", pattern = "\\.sav$", full.names = TRUE)

nacimientos <- map_df(archivos, function(x) {
  
  df <- read_sav(x, user_na = TRUE) %>% 
    zap_labels() %>%
    clean_names()

  df[] <- lapply(df, as.character)
  
  df$anio <- str_extract(basename(x), "\\d{4}")
  
  return(df)
})

nacimientos <- nacimientos %>%
  mutate(across(
    everything(),
    ~ type.convert(.x, as.is = TRUE)
  ))

nacimientos$anio <- as.integer(nacimientos$anio)

divorcios <- nacimientos

divorcios <- divorcios %>%
  mutate(
    edadhom = na_if(edadhom, 999),
    edadmuj = na_if(edadmuj, 999)
  )

```

```{r variables numericas}
numericas <- sapply(divorcios, is.numeric)
names(divorcios)[numericas]

edades <- divorcios %>%
  select(edadhom, edadmuj)

```
```{r resumen numericas}
summary(edades)

sapply(edades, mean, na.rm = TRUE)
sapply(edades, sd, na.rm = TRUE)

lapply(names(edades), function(v) {
  hist(edades[[v]],
       main = paste("Distribución", v),
       xlab = "Edad",
       col = "lightblue")
})

set.seed(123)

lapply(edades, function(x) {
  shapiro.test(sample(x[!is.na(x)], 5000))
})

```
Se evaluó la normalidad de las variables edad del hombre y edad de la mujer mediante la prueba de Shapiro-Wilk.

Para la edad de los hombres se obtuvo un estadístico W = 0.9217 con p < 0.05, mientras que para la edad de las mujeres W = 0.9292 con p < 0.05. En ambos casos se rechaza la hipótesis nula de normalidad, concluyendo que las variables no siguen una distribución normal.

El análisis gráfico mediante histogramas y la comparación entre media y mediana evidencian que ambas variables presentan asimetría positiva (sesgo hacia la derecha), caracterizada por una mayor concentración de observaciones en edades medias y una cola extendida hacia edades más altas.




```{r}
library(ggplot2)

nacimientos <- nacimientos %>%
  mutate(
    edad_madre = as.numeric(edadm),
    edad_padre = as.numeric(edadp),
    peso_libras = as.numeric(libras),
    hijos_vivos = as.numeric(tohivi)
  )

```


```{r}
ggplot(nacimientos, aes(x = edad_madre)) +
  geom_histogram(bins = 30) +
  labs(
    title = "Distribución de la edad de la madre",
    x = "Edad de la madre",
    y = "Frecuencia"
  )
```

```{r}
ggplot(nacimientos, aes(x = factor(hijos_vivos), y = edad_madre)) +
  geom_boxplot() +
  labs(
    title = "Edad de la madre según el número de hijos vivos",
    x = "Número de hijos vivos",
    y = "Edad de la madre"
  )
```

```{r}
ggplot(nacimientos, aes(x = edad_madre, y = peso_libras)) +
  geom_point(alpha = 0.3) +
  labs(
    title = "Relación entre la edad de la madre y el peso del recién nacido",
    x = "Edad de la madre",
    y = "Peso del recién nacido (libras)"
  )

```







